(function(){"use strict";var e={2080:function(e,a,n){var t=n(9242),o=n(3396);function s(e,a){const n=(0,o.up)("router-view");return(0,o.wg)(),(0,o.j4)(n)}var r=n(89);const i={},l=(0,r.Z)(i,[["render",s]]);var u=l,c=n(2483),d=(n(560),n(4870));const v={class:"main-nav"};function p(e,a){const n=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",v,[(0,o.Wm)(n,{class:"main-nav",to:{name:"audio"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Audio Mode")])),_:1}),(0,o.Wm)(n,{class:"main-nav",to:{name:"messages"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Message Mode")])),_:1})])}const g={},m=(0,r.Z)(g,[["render",p],["__scopeId","data-v-2179baea"]]);var f=m;const y=e=>((0,o.dD)("data-v-2f3e5de7"),e=e(),(0,o.Cn)(),e),_={class:"home"},h=y((()=>(0,o._)("div",{class:"main-container"},[(0,o._)("h1",null,"Personal Agent")],-1)));var w=(0,o.aZ)({__name:"HomeView",setup(e){(0,d.iH)([{type:"user",message:{id:1,content:"my content"}},{type:"assistant",message:{id:1,content:"assistant content"}}]);return(e,a)=>((0,o.wg)(),(0,o.iD)("div",_,[(0,o.Wm)(f),h]))}});const x=(0,r.Z)(w,[["__scopeId","data-v-2f3e5de7"]]);var b=x,k=(n(8858),n(1318),n(3228),n(7139)),M=n(8583),H=n(1076);function D(e){return new Promise((a=>setTimeout(a,e)))}function T(){let e=(new Date).getTime(),a="undefined"!==typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){let t=16*Math.random();return e>0?(t=(e+t)%16|0,e=Math.floor(e/16)):(t=(a+t)%16|0,a=Math.floor(a/16)),("x"===n?t:3&t|8).toString(16)}))}function C(e){console.log("scrollToBottom"),console.log(e),console.log(e?.scrollTop,e?.scrollHeight),e&&(e.scrollTop=e.scrollHeight)}const Z={class:"audio"},O={key:0,class:"audio-recording-container"},A=(0,o._)("h1",{class:"title"},"Audio Recording",-1),I={key:0,ref:"recordingControlButtonsContainer",class:"recording-control-buttons-container"},j={ref:"elapsedTimeTag",class:"recording-elapsed-time"},L={key:0,class:"red-recording-dot fa fa-circle"},q={class:"elapsed-time"},P={key:1},S=(0,o._)("i",{class:"fa fa-spinner fa-pulse fa-3x fa-fw"},null,-1),U=(0,o._)("span",{class:"sr-only"},"Loading...",-1),F=[S,U],W={ref:"textIndicatorOfAudiPlaying",class:"text-indication-of-audio-playing-container"},Y={key:0,class:"text-indication-of-audio-playing"},B=(0,o._)("span",null,".",-1),R=(0,o._)("span",null,".",-1),V=(0,o._)("span",null,".",-1),$={key:1,ref:"overlay",class:"overlay"},E=(0,o._)("div",{class:"browser-not-supporting-audio-recording-box"},[(0,o._)("p",null,"To record audio, use browsers like Chrome and Firefox that support audio recording."),(0,o._)("button",{type:"button",class:"close-browser-not-supported-box"}," Ok. ")],-1),z=[E],K="https://agent.anacreation.com/";var G=(0,o.aZ)({__name:"AudioView",setup(e){const a=(0,d.iH)(!1),n=(0,d.iH)(!1),t=(0,d.iH)(!1),s=(0,d.iH)(!1),r=(0,d.iH)(!1),i=(0,d.iH)(!1),l=(0,d.iH)(0),u=(0,d.iH)(!1),c=(0,o.Fl)((()=>{let e=Math.floor(l.value/60),a=l.value%60;return e=e<10?"0"+e:e,a=a<10?"0"+a:a,e+":"+a})),v=(0,d.iH)(null),p=(0,o.Fl)((()=>v.value?K+`audio/${v.value}`:null)),g=(0,d.iH)(null),m=(0,d.iH)(0);let f,y,_,h=null;const w=()=>{s.value=!1,a.value=!1},x=()=>{_=null,w()},b=async()=>{h&&await h.reset();try{f=await navigator.mediaDevices.getUserMedia({video:!1,audio:!0}),h=new M.RecordRTCPromisesHandler(f,{type:"audio"}),l.value=0,s.value=!1}catch(e){console.log("err",e),i.value=!0}};(0,o.bv)((()=>{try{const e=new Audio;e.muted=!0,e.autoplay=!0,e.addEventListener("canplaythrough",(()=>{console.log("loaded audio"),console.log(e.currentSrc),r.value=!0,(0,o.Y3)((()=>{e.play().then((()=>{e.muted=!1,e.volume=1,n.value=!0,u.value=!0,a.value=!1})).catch((e=>{console.log("play audio err",e)}))}))})),e.addEventListener("ended",(()=>{n.value=!1,e.muted=!0})),g.value=e}catch(e){i.value=!0}}));const T=async()=>{await b(),h?.startRecording(),t.value=!0,y=setInterval((()=>{l.value=l.value+1}),1e3)},C=async e=>{if(await D(500),!(u.value||m.value>10))try{const a=`${K}has_audio/${e}`;await H.Z.get(a);v.value=e,(0,o.Y3)((()=>{p.value&&g.value&&(g.value.src=p.value,g.value.load())}))}catch(a){m.value=m.value+1,await C(e),console.log("err",a)}},S=async()=>{await(h?.stopRecording()),t.value=!1,s.value=!0,a.value=!0,clearInterval(y),console.log("recorder",h);const e=await(h?.getBlob());if(e){u.value=!1;const a=new FormData;a.append("audio",e,"testing.mp4"),a.append("type",e.type),a.append("require_audio",!0),H.Z.post(`${K}call_with_audio`,a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{C(e.data.id)})).catch((e=>{console.log("err",e)}))}},U=async()=>{g.value&&g.value.play()};return(e,l)=>((0,o.wg)(),(0,o.iD)("div",Z,[i.value?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",O,[A,(0,o._)("i",{class:"start-recording-button fa fa-microphone","aria-hidden":"true",ref:"microphoneButton",onClick:T},null,512),t.value||s.value?((0,o.wg)(),(0,o.iD)("div",I,[(0,o._)("i",{onClick:x,class:"stop-recording-button fa fa-times-circle-o",style:{color:"red"}}),(0,o._)("div",j,[t.value?((0,o.wg)(),(0,o.iD)("i",L)):(0,o.kq)("",!0),(0,o._)("p",q,(0,k.zw)(c.value),1)],512),s.value?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("i",{key:0,onClick:S,class:"stop-recording-button fa fa-stop-circle-o","aria-hidden":"true"})),r.value?((0,o.wg)(),(0,o.iD)("i",{key:1,onClick:U,class:"stop-recording-button fa fa-play-circle-o","aria-hidden":"true"})):(0,o.kq)("",!0)],512)):(0,o.kq)("",!0),a.value?((0,o.wg)(),(0,o.iD)("div",P,F)):(0,o.kq)("",!0),(0,o._)("div",W,[n.value?((0,o.wg)(),(0,o.iD)("p",Y,[(0,o.Uk)("Audio is playing"),B,R,V])):(0,o.kq)("",!0)],512)])),i.value?((0,o.wg)(),(0,o.iD)("div",$,z,512)):(0,o.kq)("",!0)]))}});const J=G;var N=J;const Q={class:"my-message message"},X=["innerHTML"];var ee=(0,o.aZ)({__name:"MyMessage",props:{message:{}},setup(e){return(e,a)=>((0,o.wg)(),(0,o.iD)("div",Q,[(0,o._)("div",{class:"message-container",innerHTML:e.message.content},null,8,X)]))}});const ae=(0,r.Z)(ee,[["__scopeId","data-v-3ace2180"]]);var ne=ae,te=n(4478),oe=n.n(te);const se={class:"assistant-message message"},re=["innerHTML"];var ie=(0,o.aZ)({__name:"AssistantMessage",props:{message:{}},setup(e){const a=e,n=new(oe().Converter);n.setOption("tables",!0),n.setOption("ghCodeBlocks",!0);const t=(0,o.Fl)((()=>n.makeHtml(a.message.content)));return(e,a)=>((0,o.wg)(),(0,o.iD)("div",se,[(0,o._)("div",{class:"message-container",innerHTML:t.value},null,8,re)]))}});const le=(0,r.Z)(ie,[["__scopeId","data-v-0d48a9c2"]]);var ue=le;const ce=e=>((0,o.dD)("data-v-5ba5a955"),e=e(),(0,o.Cn)(),e),de={class:"message-input"},ve={class:"input-container"},pe=["onClick","disabled"],ge=ce((()=>(0,o._)("i",{class:"fas fa-paper-plane"},null,-1)));var me=(0,o.aZ)({__name:"MessageInput",emits:["submit"],setup(e,{emit:a}){const n=(0,d.iH)(""),s=a,r=()=>{n.value&&(s("submit",n.value),n.value="")};return(e,a)=>((0,o.wg)(),(0,o.iD)("div",de,[(0,o._)("div",ve,[(0,o.wy)((0,o._)("textarea",{rows:"4",placeholder:"Type your message here...","onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e)},null,512),[[t.nr,n.value]]),(0,o._)("button",{onClick:(0,t.iM)(r,["prevent"]),disabled:!n.value},[ge,(0,o.Uk)("send ")],8,pe)])]))}});const fe=(0,r.Z)(me,[["__scopeId","data-v-5ba5a955"]]);var ye=fe;const _e="https://agent.anacreation.com",he={class:"messages"};var we=(0,o.aZ)({__name:"MessageContainer",setup(e){const a=(0,d.iH)([]),n=(0,d.iH)(null),t={MyMessage:ne,AssistantMessage:ue};H.Z.get(_e+"/messages?page=1&limit=25&session_id:1212a").then((({data:e})=>{a.value=e.map((e=>({id:e.message.id,role:e.role,content:Array.isArray(e.message.content)?e.message.content[0].text:e.message.content}))).reverse(),(0,o.Y3)((()=>C(n.value)))}));const s=e=>{const t={content:e},s={id:T(),role:"user",content:e},r={id:T(),role:"assistant",content:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>Loading..'};a.value.push(s),a.value.push(r),(0,o.Y3)((()=>C(n.value))),H.Z.post(_e+"/call",t).then((({data:e})=>{a.value.pop(),a.value.push({id:e.id,role:"assistant",content:e.message}),(0,o.Y3)((()=>C(n.value)))}))},r=e=>"user"===e?t["MyMessage"]:t["AssistantMessage"];return(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"messages-container",ref_key:"messagesContainer",ref:n},[(0,o._)("div",he,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.value,(e=>((0,o.wg)(),(0,o.j4)((0,o.LL)(r(e.role)),{key:e.id,message:e},null,8,["message"])))),128))]),(0,o.Wm)(ye,{onSubmit:s})],512))}});const xe=(0,r.Z)(we,[["__scopeId","data-v-454f0e44"]]);var be=xe;const ke={class:"home"},Me={class:"main-container"};var He=(0,o.aZ)({__name:"MessagesView",setup(e){(0,d.iH)([]);return(e,a)=>{const n=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",ke,[(0,o.Wm)(n,{to:{name:"audio"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Audio Mode")])),_:1}),(0,o._)("div",Me,[(0,o.Wm)(be)])])}}});const De=(0,r.Z)(He,[["__scopeId","data-v-02d7fbec"]]);var Te=De;const Ce=[{path:"/",name:"home",component:b},{path:"/audio",name:"audio",component:N},{path:"/messages",name:"messages",component:Te}],Ze=(0,c.p7)({history:(0,c.PO)("/"),routes:Ce});var Oe=Ze,Ae=n(65),Ie=(0,Ae.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,t.ri)(u).use(Ie).use(Oe).mount("#app")}},a={};function n(t){var o=a[t];if(void 0!==o)return o.exports;var s=a[t]={exports:{}};return e[t].call(s.exports,s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(a,t,o,s){if(!t){var r=1/0;for(c=0;c<e.length;c++){t=e[c][0],o=e[c][1],s=e[c][2];for(var i=!0,l=0;l<t.length;l++)(!1&s||r>=s)&&Object.keys(n.O).every((function(e){return n.O[e](t[l])}))?t.splice(l--,1):(i=!1,s<r&&(r=s));if(i){e.splice(c--,1);var u=o();void 0!==u&&(a=u)}}return a}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[t,o,s]}}(),function(){n.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(a,{a:a}),a}}(),function(){n.d=function(e,a){for(var t in a)n.o(a,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(a){return 0===e[a]};var a=function(a,t){var o,s,r=t[0],i=t[1],l=t[2],u=0;if(r.some((function(a){return 0!==e[a]}))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(l)var c=l(n)}for(a&&a(t);u<r.length;u++)s=r[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(c)},t=self["webpackChunkvoice_recorder"]=self["webpackChunkvoice_recorder"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))}();var t=n.O(void 0,[998],(function(){return n(2080)}));t=n.O(t)})();
//# sourceMappingURL=app.38635682.js.map